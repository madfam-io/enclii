# Green runner scale set (standby/canary)
# This scale set is dormant during normal operations and activates during blue-green switches
# Usage: helm upgrade --install enclii-runners-green \
#          oci://ghcr.io/actions/actions-runner-controller-charts/gha-runner-scale-set \
#          --namespace arc-runners \
#          --values values-runner-set.yaml \
#          --values values-runner-set-green.yaml

runnerScaleSetName: "enclii-runners-green"

# Start with 0 runners (standby mode)
# During blue-green switch, this will be scaled up before blue is drained
minRunners: 0
maxRunners: 6

# Green-specific labels for identification
template:
  metadata:
    labels:
      arc.enclii.dev/color: green
      arc.enclii.dev/active: "false"
    annotations:
      arc.enclii.dev/deployed-at: ""  # Will be set by Helm
  spec:
    # Note: Do NOT define 'work' volume - ARC auto-injects it with containerMode.type=dind
    # Only define additional cache volumes here
    volumes:
      # Shared caches across blue/green
      - name: go-cache
        persistentVolumeClaim:
          claimName: arc-go-cache
      - name: npm-cache
        persistentVolumeClaim:
          claimName: arc-npm-cache
      # Green-specific Docker cache (isolated for clean rebuilds)
      - name: docker-cache
        persistentVolumeClaim:
          claimName: arc-docker-cache-green
