# =============================================================================
# Enclii Production Infrastructure - Terraform Variables
# =============================================================================
#
# SETUP INSTRUCTIONS:
# 1. Copy this file to terraform.tfvars
# 2. Fill in ALL required values below
# 3. Run: terraform init
# 4. Run: terraform plan
# 5. Run: terraform apply
#
# SECURITY: Never commit terraform.tfvars to git!
# =============================================================================

# =============================================================================
# PROVIDER CREDENTIALS (REQUIRED)
# =============================================================================

# Hetzner Cloud API Token
# Get from: https://console.hetzner.cloud/projects → Security → API Tokens
# Permissions needed: Read & Write
hetzner_token = "YOUR_HETZNER_API_TOKEN"

# Cloudflare API Token
# Get from: https://dash.cloudflare.com/profile/api-tokens
# Required permissions: Zone:DNS:Edit, Zone:Zone:Read, Account:Cloudflare Tunnel:Edit, Account:R2:Edit
cloudflare_api_token = "YOUR_CLOUDFLARE_API_TOKEN"

# Cloudflare Account ID
# Get from: https://dash.cloudflare.com → any zone → Overview (right sidebar)
cloudflare_account_id = "YOUR_CLOUDFLARE_ACCOUNT_ID"

# =============================================================================
# R2 STORAGE CREDENTIALS (REQUIRED)
# =============================================================================

# Cloudflare R2 Access Keys
# Get from: https://dash.cloudflare.com → R2 → Manage R2 API Tokens
r2_access_key_id     = "YOUR_R2_ACCESS_KEY_ID"
r2_secret_access_key = "YOUR_R2_SECRET_ACCESS_KEY"

# R2 Bucket names (can customize or use defaults)
r2_bucket_backups   = "enclii-backups"
r2_bucket_artifacts = "enclii-artifacts"

# =============================================================================
# DOMAIN CONFIGURATION (REQUIRED)
# =============================================================================

# Your primary domain (must be added to Cloudflare)
domain = "enclii.dev"

# Subdomains for services
subdomain_api = "api"   # → api.enclii.dev
subdomain_app = "app"   # → app.enclii.dev

# Email domain allowed for Zero Trust Access (for monitoring dashboards)
allowed_email_domain = "enclii.dev"

# =============================================================================
# HETZNER COMPUTE CONFIGURATION
# =============================================================================

# Datacenter location
# Options: nbg1 (Nuremberg), fsn1 (Falkenstein), hel1 (Helsinki), ash (Ashburn US), hil (Hillsboro US)
# Recommendation: Use EU (nbg1/fsn1) for 20TB bandwidth vs US (ash/hil) 3TB cap
location = "nbg1"

# Control plane configuration
# For production HA: 3 nodes (odd number required for etcd quorum)
# For staging/dev: 1 node
control_plane_count = 1
control_plane_type  = "cx21"  # 2 vCPU, 4GB RAM, €5.18/mo

# Worker node configuration
# Recommendation: Start with 2, scale based on workload
worker_count = 2
worker_type  = "cx31"  # 2 vCPU, 8GB RAM, €9.92/mo

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================

# PostgreSQL data volume size (GB)
# Recommendation: Start with 50GB, can expand later
postgres_volume_size = 50

# Build cache volume size (GB)
# Used for faster container builds
build_cache_volume_size = 100

# Redis data volume size (GB)
redis_volume_size = 10

# =============================================================================
# NETWORK SECURITY (REQUIRED)
# =============================================================================

# IP addresses allowed for SSH and Kubernetes API access
# CRITICAL: Add your office/home IP addresses here
# Format: CIDR notation ["x.x.x.x/32", "y.y.y.y/24"]
# Get your IP: curl ifconfig.me
management_ips = [
  # "YOUR_IP_ADDRESS/32",    # Your home/office IP
  # "TEAM_MEMBER_IP/32",     # Team member IP
]

# =============================================================================
# OPTIONAL FEATURES
# =============================================================================

# Enable floating IP for stable egress (adds ~€4/mo)
enable_floating_ip = false

# =============================================================================
# ENVIRONMENT
# =============================================================================

# Deployment environment: development, staging, production
environment = "production"

# Resource tags
tags = {
  project    = "enclii"
  managed_by = "terraform"
  owner      = "platform-team"
}

# =============================================================================
# COST ESTIMATE (based on above defaults)
# =============================================================================
#
# Control Plane: 1x cx21 = €5.18/mo
# Workers: 2x cx31 = €19.84/mo
# Volumes: 160GB total = ~€6.40/mo
# Cloudflare: $0 (tunnel, R2 free tier, DNS)
# Network: $0 (private network included)
#
# TOTAL: ~€31/mo (~$34/mo) for starter setup
#
# Production recommendation (3 CP + 3 workers):
# Control Plane: 3x cx21 = €15.54/mo
# Workers: 3x cx31 = €29.76/mo
# Volumes: 160GB = €6.40/mo
# TOTAL: ~€52/mo (~$57/mo)
#
# =============================================================================
